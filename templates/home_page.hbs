{{#if settings.icons_enabled}}
<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {

    function loadJSON(callback, fileName) {
      var xobj = new XMLHttpRequest();
      xobj.overrideMimeType("application/json");
      xobj.open("GET", fileName, true);
      xobj.onreadystatechange = function () {
        if (xobj.readyState == 4 && xobj.status == "200") {
          // Required use of an anonymous callback as .open will NOT return
          // a value but simply returns undefined in asynchronous mode
          callback(xobj.responseText);
        }
      };
      xobj.send(null);
    }

    console.log("wot i wsjo!");
    loadJSON(function (response) {
      let parsed = JSON.parse(response);
      console.log("Parsed", parsed);

      Object.keys(parsed).forEach(function items(itemKey) {
        document.getElementById(itemKey).setAttribute(
          "src",
          "{{asset 'icon-flag.svg'}}".replace(/[^\/]+$/, parsed[itemKey])
        );
      });

    }, "{{settings.icons}}");
  });
</script>
{{/if}}

<h1 class="visibility-hidden">{{ help_center.name }}</h1>

<section id="main-content" class="section hero">
  <div class="hero-inner">
    <h2 class="visibility-hidden">{{ t 'search' }}</h2>
    {{!-- {{search submit=false instant=settings.instant_search class='search search-full'}} --}}
    <h1 class="hero-h1">{{dc 'hero_welcome_message'}}</h1>
    {{dc 'search_with_placeholder'}}
  </div>
</section>

<div class="container">

  {{#if settings.alert_enabled}}
  <section class="message message-alert">
    {{dc 'eqx_alert_content'}}
  </section>
  {{/if}}

  {{#if settings.info_enabled}}
  <section class="message message-info">
    {{dc 'eqx_info_content'}}
  </section>
  {{/if}}

  <section class="section knowledge-base">
    <h2 class="visibility-hidden">{{ t 'categories' }}</h2>
    <section class="categories blocks">
      <ul class="blocks-list">
        {{#each categories}}
        {{#if ../has_multiple_categories}}
        <li class="blocks-item">

          <div class="blocks-image">
            <img id={{id}} src="{{asset 'icon-flag.svg'}}">
          </div>

          <a href='{{url}}' class="blocks-item-link">
            <span class="blocks-item-title">{{name}}</span>
            <span class="blocks-item-description">{{excerpt description}}</span>
          </a>
        </li>
        {{else}}
        {{#each sections}}
        <li class="blocks-item">
          <a href='{{url}}' class="blocks-item-link">
            <span class="blocks-item-title">
              {{name}}
            </span>
            <span class="blocks-item-description">{{excerpt description}}</span>
          </a>
        </li>
        {{/each}}
        {{/if}}
        {{/each}}
      </ul>
      {{pagination}}
    </section>

    {{#if promoted_articles}}
    <section class="articles">
      <h5>{{t 'promoted_articles'}}</h5>
      <ul class="article-list promoted-articles">
        {{#each promoted_articles}}
        <li class="promoted-articles-item">
          <a href="{{url}}">
            {{title}}

            {{#if internal}}
            <span class="icon-lock" title="{{t 'internal'}}"></span>
            {{/if}}
          </a>
        </li>
        {{/each}}
      </ul>
    </section>
    {{/if}}
  </section>

  {{#if help_center.community_enabled}}
  <section class="section home-section community">
    <h2>{{t 'community'}}</h2>
    {{#link 'community' class='community-link'}}
    {{t 'join_conversation'}}
    {{/link}}

    <div class="community-image"></div>
  </section>
  {{/if}}

  <section class="section home-section activity">
    {{#if settings.show_recent_activity}}
    {{recent_activity}}
    {{/if}}
  </section>
</div>