<meta content="width=device-width, initial-scale=1.0" name="viewport" />
<!-- Google Tag Manager -->
<script>(function (w, d, s, l, i) {
        w[l] = w[l] || []; w[l].push({
            'gtm.start':
                new Date().getTime(), event: 'gtm.js'
        }); var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-MRK4JFF');</script>
<!-- End Google Tag Manager -->
{{#if settings.enable_headroom}}
<script src="{{asset 'headroom.min.js'}}"></script>
{{/if}}

<script>
        console.info("---=== Version 05 ===---");
        function getCookieByName(name) {
            var b = document.cookie.match('(^|;)\\s*' + name + '\\s*=\\s*([^;]+)');
        return b ? b.pop() : null;
    }
        var refreshToken = getCookieByName("refresh_token");
</script>

{{#if signed_in}}
<script>
    console.info("Signed in.");
    sessionStorage.removeItem("phone_reg");
</script>
{{else}}
<script>
        if (refreshToken === null) {
        console.info("Signed out.");
        sessionStorage.clear();
    } else {

        if (sessionStorage.getItem("last_refresh_token") !== refreshToken) {
            sessionStorage.clear();
            sessionStorage.setItem("last_refresh_token", refreshToken);
        }

        if (refreshToken !== null && Number(sessionStorage.getItem("sso_checked")) < 3) {
            console.info("NOT Signed in. - Querying ZENDESKSSO...");
            sessionStorage.setItem("sso_checked", Number(sessionStorage.getItem("sso_checked")) + 1);
            location = "{{settings.country_site_url}}" + "account/zendesksso/?nativeMode=1&return_to=" + location.href;
        }

        if (Number(sessionStorage.getItem("sso_checked")) >= 3) {
            console.info("Phone reg.");
            sessionStorage.setItem("phone_reg", true);
        }
    }
</script>
{{/if}}
